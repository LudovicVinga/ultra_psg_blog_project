{% extends 'themes/base_visitor.html.twig' %}

{% block title %}Accueil{% endblock %}

{% block description %}Bienvenue sur Ultra PSG ! Suivez l'actualité du club de la capitale comme ci vous y étiez !{% endblock %}

{% block keywords %}PSG, Paris Saint-Germain, Paris SG, football, Ligue 1, PSG news, PSG matches, PSG joueurs, Parc des Princes, Champions League, PSG transferts, PSG fans, PSG resultats{% endblock %}

{% block main %}

    {# hero-section #}
    <header>
        {% include 'components/welcomeTitle.twig' with {"h1" : "ULTRA PSG"} %}
    </header>

    {# last-posts-section #}
    <section class="text-center py-5">
        <div>
            <h1 class="text-danger display-5 fw-bold fst-italic">LES DERNIERES NEWS</h1>
            <h4 class="text-primary">Ne ratez rien de l'actualité du Paris saint-Germain !</h4>
        </div>

        <div class="container my-4">
            {# Last post #}
            <div class="row mb-4">
                <div class="col-12">
                <div class="card shadow h-100 border-0 rounded-3 overflow-hidden">
                    {% if posts[0].image %}
                    <img
                        src="{{ vich_uploader_asset(posts[0], 'imageFile') | imagine_filter('visitor_post_thumb') }}"
                        class="card-img-top rounded-top-3"
                        style="object-fit:contain; max-height:220px; background:#f8f9fa;"
                        alt="{{ posts[0].title }}">
                    {% else %}
                    <img
                        src="/images/static/visitor/news/default_post_img.png"
                        class="card-img-top rounded-top-3"
                        style="object-fit:contain; max-height:220px; background:#f8f9fa;"
                        alt="{{ posts[0].title }}">
                    {% endif %}
                    <div class="card-body d-flex flex-column justify-content-center align-items-center text-center p-4" style="min-height:190px;">
                    <span class="badge bg-primary bg-opacity-10 text-primary rounded-pill mb-2 small">
                        {{ posts[0].category.name }}
                    </span>
                    <h4 class="fw-bold mb-2">{{ posts[0].title|u.truncate(45, '…') }}</h4>
                    <p class="text-secondary mb-2 small">{{ posts[0].description|u.truncate(70, '…') }}</p>
                    <small class="text-muted mb-2">Publié {{ posts[0].publishedAt|ago }}</small>
                    <a href="{{ path('app_visitor_news_post_show', {'id':posts[0].id, 'slug':posts[0].slug}) }}"
                        class="btn btn-outline-primary rounded-pill px-4 py-2 fw-semibold shadow-sm mt-2 small">
                        Lire l'article
                    </a>
                    </div>
                </div>
                </div>
            </div>

            {# Post 2 and 3 #}
            <div class="row g-3">
                {% for post in posts|slice(1,2) %}
                <div class="col-md-6">
                    <div class="card shadow-sm border-0 rounded-3 overflow-hidden bg-white">
                    {% if post.image %}
                        <img
                        src="{{ vich_uploader_asset(post, 'imageFile') | imagine_filter('visitor_post_thumb') }}"
                        class="card-img-top rounded-top-3"
                        style="object-fit:contain; max-height:140px; background:#f8f9fa;"
                        alt="{{ post.title }}">
                    {% else %}
                        <img
                        src="/images/static/visitor/news/default_post_img.png"
                        class="card-img-top rounded-top-3"
                        style="object-fit:contain; max-height:140px; background:#f8f9fa;"
                        alt="{{ post.title }}">
                    {% endif %}
                    <div class="card-body d-flex flex-column justify-content-center align-items-center text-center p-3" style="min-height:135px;">
                        <span class="badge bg-primary bg-opacity-10 text-primary rounded-pill mb-2 small">
                        {{ post.category.name }}
                        </span>
                        <h6 class="fw-bold mb-2" style="font-size:1rem;">
                        {{ post.title|u.truncate(32, '…') }}
                        </h6>
                        <p class="text-secondary mb-2 small">{{ post.description|u.truncate(45, '…') }}</p>
                        <small class="text-muted mb-2">Publié {{ post.publishedAt|ago }}</small>
                        <a href="{{ path('app_visitor_news_post_show', {'id':post.id, 'slug':post.slug}) }}"
                        class="btn btn-outline-primary btn-sm rounded-pill mt-2 fw-semibold px-3">
                        Lire
                        </a>
                    </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div class="d-flex justify-content-center mt-5">
                <a href="{{ path('app_visitor_news') }}" class="btn btn-lg btn-primary rounded-pill px-5 fw-semibold shadow-sm">
                Toute l'actualité
                </a>
            </div>
        </div>
    </section>

    {# Last comment section #}
    <section class="latest-comments my-5 py-5" 
    style="background: linear-gradient(135deg, #d90429 0%, #fff 50%, #003471 100%); border-radius: 12px;">
        <div class="container">
            <h2 class="text-center mb-4 text-white fw-bold" style="text-shadow: 0 2px 8px rgba(0,0,0,0.6);">
                Ils en parlent !
            </h2>

            {% if latestComments|length > 0 %}
                <ul class="list-unstyled row g-4 mb-2">
                    {% for comment in latestComments %}
                        <li class="col-12 col-md-6 col-lg-4">
                            <div class="card h-100 shadow-sm rounded-3" style="background: rgba(255, 255, 255, 0.95);">
                                <div class="card-body d-flex flex-column">
                                    <div class="mb-3 d-flex align-items-center">

                                        <div>
                                            <strong class="d-block">{{ comment.user.firstName }} {{ comment.user.lastName }}</strong>
                                            <small class="text-muted" title="{{ comment.createdAt|date('c') }}">
                                                le {{ comment.createdAt|date('d/m/Y H:i') }}
                                            </small>
                                        </div>

                                        {# Calcul le nombre de commentaires de l'utilisateur #}
                                        {% set nbComments = comment.user.comments|length %}

                                        <div class="ms-auto">
                                            {% if nbComments >= 7 %}
                                                <span class="badge rounded-pill bg-warning text-dark px-3 py-2 fw-semibold">
                                                    Légende du Parc
                                                </span>
                                            {% elseif nbComments > 3 %}
                                                <span class="badge rounded-pill bg-danger px-3 py-2 fw-semibold">
                                                    </i>Ultra Rouge & Bleu
                                                </span>
                                            {% elseif nbComments > 0 %}
                                                <span class="badge rounded-pill bg-primary px-3 py-2 fw-semibold">
                                                    Supporter PSG
                                                </span>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div>
                                        <p class="card-text fst-italic flex-grow-1">{{ comment.content|u.truncate(40, '...') }}</p>
                                    </div>
                                </div>
                            </div>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p class="text-center text-white fw-semibold">Aucun commentaire pour le moment.</p>
            {% endif %}

            <h2 class="text-center my-5 text-white fw-bold" style="text-shadow: 0 2px 8px rgba(0,0,0,0.6);">
                Toi aussi tu veux donner ton avis ?
            </h2>
            <div class="d-flex justify-content-center mt-5">
                <a href="{{ app.user ? path('app_visitor_news') : path('app_register') }}" class="btn btn-lg btn-primary rounded-pill px-5 fw-semibold shadow-sm">
                C'est ici
                </a>
            </div>
        </div>
    </section>

    {# About section #}
    <section class="my-5 py-5 bg-white" id="about-me">
        <div class="text-center">
            <h1 class="text-danger display-5 fw-bold fst-italic">ULTRA PSG c'est quoi ?</h1>
            <h4 class="text-primary">Une initiative pour les passionnés</h4>
        </div>

        <div class="container my-5">
            <div class="row">
                <div class="col-lg-6 text-center d-flex flex-column justify-content-center align-items-center mb-5 mb-lg-0">
                    {# Img #}
                    <img src="/images/static/visitor/tribune.jpg" class="img-fluid border border-5 border-primary shadow" alt="Photographie d'une tribune du stade du Paris saint-Germain : Parc des princes">
                </div>

                <div class="col-lg-6 d-flex flex-column justify-content-center align-items-center">
                    {# text #}
                    <p>
                        Passionnés par le Paris Saint-Germain, ce blog est dédié à toute la communauté des supporters désireux de suivre de près l’actualité du club. Vous y retrouverez les dernières nouvelles, l’analyse des matchs, les rumeurs de transferts, les mouvements du mercato et les sujets chauds qui font vibrer le monde du PSG. <hr> Qu’il s’agisse des performances de l’équipe, des interviews exclusives, des prouesses de nos joueurs préférés ou des coulisses du club, notre objectif est de partager avec vous toute l’intensité et l’émotion de la vie parisienne au quotidien. Rejoignez-nous pour vivre pleinement chaque instant de l’aventure PSG !
                    </p>             
                </div>
            </div>
            <div class="d-flex justify-content-center my-5">
                <a href="{{path('app_visitor_contact_create')}}" class="btn btn-lg btn-primary rounded-pill px-5 fw-semibold shadow-sm">Des questions ?</a>
            </div>
        </div>
    </section>

{% endblock %}